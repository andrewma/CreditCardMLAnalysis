prob5 = (1005+104)/1319
prob5
glm.fits5 <- glm(card~reports+income+owner+share+selfemp+dependents+majorcards+active,data = CreditCard, family = binomial())
glm.probs5= predict(glm.fits5,CreditCard,type="response")
glm.pred5 = rep(0,length(glm.probs5))
glm.pred5[glm.probs5>.5]=1
table5 = table(glm.pred5,CreditCard$card)
table5
prob5 = (1000+293)/1319
prob5
glm.fits4 <- glm(card~reports,data = CreditCard, family = binomial())
glm.probs4 = predict(glm.fits4,CreditCard,type="response")
glm.pred4 = rep(0,length(glm.probs4))
glm.pred4[glm.probs4>.5]=1
table4 = table(glm.pred4,CreditCard$card)
table4
prob4 = (1005+104)/1319
prob4(digits=20)
library(ISLR)
library(AER)
library(ggplot2)
data("CreditCard")
CreditCard = data.frame(CreditCard)
names(CreditCard)
#CreditCard$cardnum = as.numeric(CreditCard$card)
#CreditCard$cardnum[CreditCard$cardnum == 1] = 0
#CreditCard$cardnum[CreditCard$cardnum == 2] = 2.22044604925031e-16
#head(CreditCard$cardnum)
nrow(CreditCard)
glm.fits1 <- glm(card~reports+share+selfemp+majorcards+active,data = CreditCard, family = binomial())
glm.probs1 = predict(glm.fits1,CreditCard,type="response")
glm.pred1 = rep(0,length(glm.probs1))
glm.pred1[glm.probs1>.5]=1
table1 = table(glm.pred1,CreditCard$card)
table1
prob1 = (1000+294)/1319
prob1
glm.fits2 <- glm(card~reports+share+selfemp+share+owner,data = CreditCard, family = binomial())
glm.probs2 = predict(glm.fits2,CreditCard,type="response")
glm.pred2 = rep(0,length(glm.probs2))
glm.pred2[glm.probs2>.5]=1
table2 = table(glm.pred2,CreditCard$card)
table2
prob2 = (999+295)/1319
prob2
glm.fits3 <- glm(card~reports+share+selfemp,data = CreditCard, family = binomial())
glm.probs3 = predict(glm.fits3,CreditCard,type="response")
glm.pred3 = rep(0,length(glm.probs3))
glm.pred3[glm.probs3>.5]=1
table3 = table(glm.pred3,CreditCard$card)
table3
prob3 = (998+295)/1319
prob3
glm.fits4 <- glm(card~reports,data = CreditCard, family = binomial())
glm.probs4 = predict(glm.fits4,CreditCard,type="response")
glm.pred4 = rep(0,length(glm.probs4))
glm.pred4[glm.probs4>.5]=1
table4 = table(glm.pred4,CreditCard$card)
table4
prob4 = (1005+104)/1319
prob4
glm.fits5 <- glm(card~reports+income+owner+share+selfemp+dependents+majorcards+active,data = CreditCard, family = binomial())
glm.probs5= predict(glm.fits5,CreditCard,type="response")
glm.pred5 = rep(0,length(glm.probs5))
glm.pred5[glm.probs5>.5]=1
table5 = table(glm.pred5,CreditCard$card)
table5
prob5 = (1000+293)/1319
prob5
library(ISLR)
library(AER)
library(ggplot2)
data("CreditCard")
CreditCard = data.frame(CreditCard)
names(CreditCard)
nrow(CreditCard)
glm.fits1 <- glm(card~reports+share+selfemp+majorcards+active,data = CreditCard, family = binomial())
glm.probs1 = predict(glm.fits1,CreditCard,type="response")
glm.pred1 = rep(0,length(glm.probs1))
glm.pred1[glm.probs1>.5]=1
table1 = table(glm.pred1,CreditCard$card)
table1
prob1 = (1000+294)/1319
prob1
glm.fits2 <- glm(card~reports+share+selfemp+share+owner,data = CreditCard, family = binomial())
glm.probs2 = predict(glm.fits2,CreditCard,type="response")
glm.pred2 = rep(0,length(glm.probs2))
glm.pred2[glm.probs2>.5]=1
table2 = table(glm.pred2,CreditCard$card)
table2
prob2 = (999+295)/1319
prob2
glm.fits3 <- glm(card~reports+share+selfemp,data = CreditCard, family = binomial())
glm.probs3 = predict(glm.fits3,CreditCard,type="response")
glm.pred3 = rep(0,length(glm.probs3))
glm.pred3[glm.probs3>.5]=1
table3 = table(glm.pred3,CreditCard$card)
table3
prob3 = (998+295)/1319
prob3
glm.fits4 <- glm(card~reports,data = CreditCard, family = binomial())
glm.probs4 = predict(glm.fits4,CreditCard,type="response")
glm.pred4 = rep(0,length(glm.probs4))
glm.pred4[glm.probs4>.5]=1
table4 = table(glm.pred4,CreditCard$card)
table4
prob4 = (1005+104)/1319
prob4
glm.fits5 <- glm(card~reports+income+owner+share+selfemp+dependents+majorcards+active,data = CreditCard, family = binomial())
glm.probs5= predict(glm.fits5,CreditCard,type="response")
glm.pred5 = rep(0,length(glm.probs5))
glm.pred5[glm.probs5>.5]=1
table5 = table(glm.pred5,CreditCard$card)
table5
prob5 = (1000+293)/1319
prob5
glm.fits2 <- glm(card~reports+share+selfemp+dependents+months,data = CreditCard, family = binomial())
glm.probs2 = predict(glm.fits2,CreditCard,type="response")
glm.pred2 = rep(0,length(glm.probs2))
glm.pred2[glm.probs2>.5]=1
table2 = table(glm.pred2,CreditCard$card)
table2
prob2 = (999+295)/1319
prob2
glm.fits2 <- glm(card~reports+share+selfemp+dependents+months,data = CreditCard, family = binomial())
glm.probs2 = predict(glm.fits2,CreditCard,type="response")
glm.pred2 = rep(0,length(glm.probs2))
glm.pred2[glm.probs2>.5]=1
table2 = table(glm.pred2,CreditCard$card)
table2
prob2 = (998+295)/1319
prob2
summary(table4)
summary(glm.fits1)
glm.fits1summary=summar(glm.fits1)
glm.fits1summary=summary(glm.fits1)
coefs=as.data.frame(glm.fits1summary$coefficients[-1,1:2])
names(coefs)[2]="se"
coefs$vars=rownames(coefs)
ggplot(coefs, aes(vars,Estimate)) +
geom_errorbar(aes(ymin=Estimate-1.96*se,ymax=Estimate+1.96*se) lwd=1, colour="red",width=0)+
glm.fits1summary=summary(glm.fits1)
coefs=as.data.frame(glm.fits1summary$coefficients[-1,1:2])
names(coefs)[2]="se"
coefs$vars=rownames(coefs)
ggplot(coefs, aes(vars,Estimate)) +
geom_errorbar(aes(ymin=Estimate-1.96*se,ymax=Estimate+1.96*se),lwd=1, colour="red",width=0)+
geom_errorbar(aes(ymin=Estimate - se,ymax=Estimate+se),lwd=1.5,colour="blue",width=0)+
geom_point(size=2,pch=21,fill="yellow")
glm.fits=glm(card~reports+share+selfemp+majorcards+active,data=CreditCard,family = binomial(link = "probit"))
glm.probs=predict(glm.fits,CreditCard,type="response")
glm.pred=rep("0",length(glm.fits))
glm.pred[glm.probs>.5]="1"
table(glm.pred,CreditCard$card)
mean(glm.pred==CreditCard$card)
glm.fits=glm(card~reports+share+selfemp+majorcards+active,data=CreditCard,family = binomial(link = "probit"))
glm.probs=predict(glm.fits,CreditCard,type="response")
glm.pred=rep("0",1319)
glm.pred[glm.probs>.5]="1"
table(glm.pred,CreditCard$card)
mean(glm.pred==CreditCard$card)
glm.fits=glm(card~reports+share+selfemp+majorcards+active,data=CreditCard,family = binomial(link = "probit"))
glm.probs=predict(glm.fits,CreditCard,type="response")
glm.pred=rep("0",length(glm.fits))
glm.pred[glm.probs>.5]="1"
table(glm.pred,CreditCard$card)
mean(glm.pred==CreditCard$card)
glm.fits=glm(card~reports+share+selfemp+majorcards+active,data=CreditCard,family = binomial(link = "probit"))
glm.probs=predict(glm.fits,CreditCard,type="response")
glm.pred=rep("0",length(glm.probs))
glm.pred[glm.probs>.5]="1"
table(glm.pred,CreditCard$card)
mean(glm.pred==CreditCard$card)
glm.fits=glm(card~reports+share+selfemp+majorcards+active,data=CreditCard,family = binomial(link = "probit"))
glm.probs=predict(glm.fits,CreditCard,type="response")
glm.pred=rep("0",length(glm.probs))
glm.pred[glm.probs>.5]="1"
table(glm.pred,CreditCard$card)
mean(glm.pred==CreditCard$card)
logitProb = (999+294)/1319
glm.fits=glm(card~reports+share+selfemp+majorcards+active,data=CreditCard,family = binomial(link = "probit"))
glm.probs=predict(glm.fits,CreditCard,type="response")
glm.pred=rep("0",length(glm.probs))
glm.pred[glm.probs>.5]="1"
table(glm.pred,CreditCard$card)
mean(glm.pred==CreditCard$card)
logitProb = (999+294)/1319
logitProb
library(CreditCard)
train.X=cbind(reports,share)[train,]
data("CreditCard")
train.X=cbind(reports,share)[train,]
data("CreditCard")
train.X=cbind(CreditCard$reports,share)[train,]
data("CreditCard")
train.X=cbind(CreditCard$reports,CreditCard$share)[train,]
library(class)
train.X=cbind(CreditCard$reports,CreditCard$share)[train,]
library(class)
train.X=cbind(CreditCard$reports,CreditCard$share)[train,]
library(class)
train.X=cbind(CreditCard$reports,CreditCard$share)[0,]
test.X=cbind(CreditCard$reports,CreditCard$share)[!0,]
train.card=card[train]
library(class)
train.X=cbind(CreditCard$reports,CreditCard$share)[0,]
test.X=cbind(CreditCard$reports,CreditCard$share)[!0,]
train.card=card[reports]
library(ISLR)
library(AER)
library(ggplot2)
data("CreditCard")
CreditCard = data.frame(CreditCard)
names(CreditCard)
nrow(CreditCard)
glm.fits1 <- glm(card~reports+share+selfemp+majorcards+active,data = CreditCard, family = binomial())
glm.probs1 = predict(glm.fits1,CreditCard,type="response")
glm.pred1 = rep(0,length(glm.probs1))
glm.pred1[glm.probs1>.5]=1
table1 = table(glm.pred1,CreditCard$card)
table1
prob1 = (1000+294)/1319
prob1
glm.fits2 <- glm(card~reports+share+selfemp+dependents+months,data = CreditCard, family = binomial())
glm.probs2 = predict(glm.fits2,CreditCard,type="response")
glm.pred2 = rep(0,length(glm.probs2))
glm.pred2[glm.probs2>.5]=1
table2 = table(glm.pred2,CreditCard$card)
table2
prob2 = (998+295)/1319
prob2
glm.fits3 <- glm(card~reports+share+selfemp,data = CreditCard, family = binomial())
glm.probs3 = predict(glm.fits3,CreditCard,type="response")
glm.pred3 = rep(0,length(glm.probs3))
glm.pred3[glm.probs3>.5]=1
table3 = table(glm.pred3,CreditCard$card)
table3
prob3 = (998+295)/1319
prob3
glm.fits4 <- glm(card~reports,data = CreditCard, family = binomial())
glm.probs4 = predict(glm.fits4,CreditCard,type="response")
glm.pred4 = rep(0,length(glm.probs4))
glm.pred4[glm.probs4>.5]=1
table4 = table(glm.pred4,CreditCard$card)
table4
prob4 = (1005+104)/1319
prob4
glm.fits5 <- glm(card~reports+income+owner+share+selfemp+dependents+majorcards+active,data = CreditCard, family = binomial())
glm.probs5= predict(glm.fits5,CreditCard,type="response")
glm.pred5 = rep(0,length(glm.probs5))
glm.pred5[glm.probs5>.5]=1
table5 = table(glm.pred5,CreditCard$card)
table5
prob5 = (1000+293)/1319
prob5
summary(glm.fits1)
glm.fits1summary=summary(glm.fits1)
coefs=as.data.frame(glm.fits1summary$coefficients[-1,1:2])
names(coefs)[2]="se"
coefs$vars=rownames(coefs)
ggplot(coefs, aes(vars,Estimate)) +
geom_errorbar(aes(ymin=Estimate-1.96*se,ymax=Estimate+1.96*se),lwd=1, colour="red",width=0)+
geom_errorbar(aes(ymin=Estimate - se,ymax=Estimate+se),lwd=1.5,colour="blue",width=0)+
geom_point(size=2,pch=21,fill="yellow")
glm.fits=glm(card~reports+share+selfemp+majorcards+active,data=CreditCard,family = binomial(link = "probit"))
glm.probs=predict(glm.fits,CreditCard,type="response")
glm.pred=rep("0",length(glm.probs))
glm.pred[glm.probs>.5]="1"
table(glm.pred,CreditCard$card)
mean(glm.pred==CreditCard$card)
logitProb = (999+294)/1319
logitProb
library(class)
train.X=cbind(CreditCard$reports,CreditCard$share)[0,]
test.X=cbind(CreditCard$reports,CreditCard$share)[!0,]
train.card=card[reports]
glm.fits1summary=summary(glm.fits1)
coefs=as.data.frame(glm.fits1summary$coefficients[-1,1:2])
names(coefs)[2]="se"
coefs$vars=rownames(coefs)
ggplot(coefs, aes(vars,Estimate)) +
geom_errorbar(aes(ymin=Estimate-1.96*se,ymax=Estimate+1.96*se),lwd=1, colour="red",width=0)+
geom_errorbar(aes(ymin=Estimate - se,ymax=Estimate+se),lwd=1.5,colour="blue",width=0)+
geom_point(size=2,pch=21,fill="yellow")
library(class)
train = CreditCard[1:600,]
train.X=cbind(CreditCard$reports,CreditCard$share)[train,]
library(class)
train = CreditCard[1:600,]
train.X=cbind(reports,share)[train,]
library(class)
train = CreditCard[1:600,]
train.X=cbind(CreditCard$reports,CreditCard$share)[train,]
library(class)
train = CreditCard[1:600,]
head(train)
train.X=cbind(CreditCard$reports,CreditCard$share)[train,]
library(class)
train = CreditCard$card[1:600,]
library(class)
train = (card == 0)
library(class)
train = (CreditCard$card == 0)
head(train)
train.X=cbind(CreditCard$reports,CreditCard$share)[train,]
test.X=cbind(CreditCard$reports,CreditCard$share)[!train,]
train.card=card[train]
library(class)
train = (CreditCard$card == 0)
head(train)
train.X=cbind(CreditCard$reports,CreditCard$share)[train,]
test.X=cbind(CreditCard$reports,CreditCard$share)[!train,]
train.card=CreditCard$card[train]
set.seed(1)
knn.pred=knn(train.X,test.X,train.card,k=1)
library(class)
train = (CreditCard$card == 0)
head(train)
train.X=cbind(CreditCard$reports,CreditCard$share)[train,]
test.X=cbind(CreditCard$reports,CreditCard$share)[!train,]
train.card=CreditCard$card[train]
set.seed(1)
knn.pred=knn(train.X,test.X,train.card,k=3)
library(class)
train = (CreditCard$card == 0)
head(train)
train.X=cbind(CreditCard$reports,CreditCard$share)[train,]
test.X=cbind(CreditCard$reports,CreditCard$share)[!train,]
train.card=CreditCard$card[train]
set.seed(1)
#knn.pred=knn(train.X,test.X,train.card,k=3)
knn.pred = knn(data.frame(train.X), data.frame(test.X), train.card, k=1)
library(class)
train = (CreditCard$card == 0)
head(train)
train.X=cbind(CreditCard$reports,CreditCard$share)[train,]
test.X=cbind(CreditCard$reports,CreditCard$share)[!train,]
train.card=CreditCard$card[train]
set.seed(1)
#knn.pred=knn(train.X,test.X,train.card,k=3)
knn.pred = knn(data.frame(train.X), data.frame(test.X), train.card, k=2)
library(class)
train = (CreditCard$card == 0)
head(train)
train.X=cbind(CreditCard$reports,CreditCard$share)[train,]
test.X=cbind(CreditCard$reports,CreditCard$share)[!train,]
train.card=CreditCard$card[train]
set.seed(5)
#knn.pred=knn(train.X,test.X,train.card,k=3)
knn.pred = knn(data.frame(train.X), data.frame(test.X), train.card, k=2)
library(class)
train = (CreditCard$card == 0)
head(train)
train.X=cbind(CreditCard$reports,CreditCard$share)[train,]
test.X=cbind(CreditCard$reports,CreditCard$share)[!train,]
train.card=CreditCard$card[train]
set.seed(5)
knn.pred=knn(train.X,test.X,train.card,k=3)
library(class)
train = (CreditCard$reports >3)
train.X=cbind(CreditCard$reports,CreditCard$share)[train,]
test.X=cbind(CreditCard$reports,CreditCard$share)[!train,]
train.card=CreditCard$card[train]
set.seed(5)
knn.pred=knn(train.X,test.X,train.card,k=3)
#knn.pred = knn(data.frame(train.X), data.frame(test.X), train.card, k=2)
table(knn.pred,CreditCard$card)
library(class)
train = (CreditCard$card[1,600],)
library(class)
train = (CreditCard$creports>2)
train.X=cbind(CreditCard$reports,CreditCard$share)[train,]
test.X=cbind(CreditCard$reports,CreditCard$share)[!train,]
train.card=CreditCard$card[train]
set.seed(5)
knn.pred=knn(train.X,test.X,train.card,k=3)
library(class)
train = (CreditCard$reports>2)
train.X=cbind(CreditCard$reports,CreditCard$share)[train,]
test.X=cbind(CreditCard$reports,CreditCard$share)[!train,]
train.card=CreditCard$card[train]
set.seed(5)
knn.pred=knn(train.X,test.X,train.card,k=3)
#knn.pred = knn(data.frame(train.X), data.frame(test.X), train.card, k=2)
table(knn.pred,CreditCard$card)
library(class)
train = (CreditCard$card[1:600])
train.X=cbind(CreditCard$reports,CreditCard$share)[train,]
test.X=cbind(CreditCard$reports,CreditCard$share)[!train,]
train.card=CreditCard$card[train]
set.seed(5)
knn.pred=knn(train.X,test.X,train.card,k=3)
library(class)
train = (CreditCard$card[1:600,])
library(class)
train = (CreditCard$card[1,600])
library(class)
train = (CreditCard$card == 0)
head(train)
train.X=cbind(CreditCard$reports,CreditCard$share)[train,]
test.X=cbind(CreditCard$reports,CreditCard$share)[!train,]
train.card=CreditCard$card[train]
set.seed(5)
knn.pred=knn(train.X,test.X,train.card,k=3)
library(class)
train = (CreditCard$card == 1)
head(train)
train.X=cbind(CreditCard$reports,CreditCard$share)[train,]
test.X=cbind(CreditCard$reports,CreditCard$share)[!train,]
train.card=CreditCard$card[train]
set.seed(5)
knn.pred=knn(train.X,test.X,train.card,k=3)
library(class)
train = (CreditCard$dependents <3)
head(train)
train.X=cbind(CreditCard$reports,CreditCard$share)[train,]
test.X=cbind(CreditCard$reports,CreditCard$share)[!train,]
train.card=CreditCard$card[train]
set.seed(5)
knn.pred=knn(train.X,test.X,train.card,k=3)
#knn.pred = knn(data.frame(train.X), data.frame(test.X), train.card, k=2)
table(knn.pred,CreditCard$card)
library(class)
train = (CreditCard$dependents <3)
head(train)
train.X=cbind(CreditCard$reports,CreditCard$share)[train,]
test.X=cbind(CreditCard$reports,CreditCard$share)[!train,]
train.card=CreditCard$card[train]
set.seed(5)
knn.pred=knn(train.X,test.X,train.card,k=3)
#knn.pred = knn(data.frame(train.X), data.frame(test.X), train.card, k=2)
#table(knn.pred,CreditCard$card)
library(class)
train = (CreditCard$dependents <3)
head(train)
train.X=cbind(CreditCard$reports,CreditCard$share)[train,]
test.X=cbind(CreditCard$reports,CreditCard$share)[!train,]
train.card=CreditCard$card[train]
set.seed(5)
knn.pred=knn(train.X,test.X,train.card,k=3)
#knn.pred = knn(data.frame(train.X), data.frame(test.X), train.card, k=2)
knn.pred
#table(knn.pred,CreditCard$card)
library(class)
train = (CreditCard$cards)
head(train)
train.X=cbind(CreditCard$reports,CreditCard$share)[train,]
test.X=cbind(CreditCard$reports,CreditCard$share)[!train,]
library(class)
train = (CreditCard$reports>3)
head(train)
train.X=cbind(CreditCard$reports,CreditCard$share)[train,]
test.X=cbind(CreditCard$reports,CreditCard$share)[!train,]
train.card=CreditCard$card[train]
set.seed(5)
knn.pred=knn(train.X,test.X,train.card,k=3)
#knn.pred = knn(data.frame(train.X), data.frame(test.X), train.card, k=2)
knn.pred
#table(knn.pred,CreditCard$card)
library(class)
train = (CreditCard[1,600])
head(train)
train.X=cbind(CreditCard$reports,CreditCard$share)[train,]
test.X=cbind(CreditCard$reports,CreditCard$share)[!train,]
library(class)
train = (CreditCard[1,659])
head(train)
train.X=cbind(CreditCard$reports,CreditCard$share)[train,]
test.X=cbind(CreditCard$reports,CreditCard$share)[CreditCard[660,1329],]
train.card=CreditCard$card[train]
set.seed(5)
knn.pred=knn(train.X,test.X,train.card,k=3)
library(class)
train = (CreditCard[1,659])
head(train)
train.X=cbind(CreditCard$reports,CreditCard$share)[train,]
test.X=cbind(CreditCard$reports,CreditCard$share)[CreditCard[660,1319],]
train.card=CreditCard$card[train]
set.seed(5)
knn.pred=knn(train.X,test.X,train.card,k=3)
library(class)
train = (CreditCard[1,659])
head(train)
train.X=cbind(CreditCard$reports,CreditCard$share)[train,]
test.X=cbind(CreditCard$reports,CreditCard$share)[CreditCard[660,1319],]
train.card=CreditCard$card[train]
set.seed(5)
knn.pred=knn(train.X,test.X,train.card,k=30)
library(class)
train = (CreditCard[1,659])
head(train)
train.X=cbind(CreditCard$reports,CreditCard$share)[train,]
test.X=cbind(CreditCard$reports,CreditCard$share)[CreditCard[660,1319],]
train.card=CreditCard$card[train]
set.seed(5)
knn.pred=knn(train.X,test.X,train.card,k=30)
library(class)
train = (CreditCard[1,659])
head(train)
train.X=cbind(CreditCard$reports,CreditCard$share)[train,]
test.X=cbind(CreditCard$reports,CreditCard$share)[CreditCard[660,1319],]
train.card=CreditCard$card[train]
set.seed(5)
knn.pred=knn(train.X,test.X,train.card,k=0)
library(class)
train = (CreditCard[1,659])
head(train)
train.X=cbind(CreditCard$reports,CreditCard$share)[train,]
test.X=cbind(CreditCard$reports,CreditCard$share)[CreditCard[660,1319],]
train.card=CreditCard$card[train]
set.seed(5)
knn.pred=knn(train.X,test.X,train.card,k=1)
